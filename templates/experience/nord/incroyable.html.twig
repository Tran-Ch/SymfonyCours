{# templates/experience/nord/incroyable.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Expérience incroyable du Nord{% endblock %}

{% block stylesheets %}
  {{ parent() }}
  <style>
    main {
      margin-top: 130px;
      padding: 40px 20px 60px 20px;
      background-color: rgba(233, 238, 209, 1);
    }

    .grid-page {
      max-width: 1200px;
      margin: 0 auto;
    }

    .grid-page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .grid-page-header h1 {
      font-size: 26px;
      color: #4a5932;
      margin: 0;
    }

    .grid-page-header a {
      font-size: 14px;
    }

    /* Đoạn mô tả dưới tiêu đề */
    .grid-page-intro {
      font-size: 14px;
      line-height: 1.6;
      color: #3d4a27;
      margin-bottom: 24px;
    }

    .grid-wrapper {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      grid-auto-rows: minmax(200px, auto);
      gap: 20px;
    }

    .grid-card {
      background-color: #d7e48e;
      border-radius: 14px;
      padding: 12px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.15);
      display: flex;
      flex-direction: column;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .grid-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.18);
    }

    .grid-card-title {
      font-weight: bold;
      margin-bottom: 8px;
      font-size: 16px;
      color: #3d4a27;
      min-height: 48px;   /* cố định chiều cao cho tiêu đề */
      display: flex;
      align-items: center;
    }

    .grid-card-image {
      width: 100%;
      height: 180px;
      object-fit: cover;
      border-radius: 10px;
      margin-bottom: 8px;
    }

    .grid-card-text {
      font-size: 13px;
      color: #334;
      flex-grow: 1;
    }

    .grid-card-footer {
      font-size: 12px;
      color: #566;
      margin-top: 8px;
      text-align: right;
    }

    @media (max-width: 992px) {
      .grid-wrapper {
        grid-template-columns: repeat(2, minmax(0, 1fr));
        grid-auto-rows: minmax(180px, auto);
      }
    }

    @media (max-width: 576px) {
      main {
        margin-top: 110px;
        padding: 25px 10px 40px 10px;
      }
      .grid-wrapper {
        grid-template-columns: 1fr;
        grid-auto-rows: minmax(180px, auto);
      }
    }
  </style>
{% endblock %}

{% block body %}
<section class="grid-page">
  <div class="grid-page-header">
    <h1>EXPÉRIENCE INCROYABLE DU NORD</h1>
    <a href="{{ path('app_nord') }}" class="btn btn-long">← Retour à la carte du Nord</a>
  </div>

  <p class="grid-page-intro">
    Le Nord du Vietnam est un véritable tableau vivant où nature grandiose, traditions ancestrales
    et rencontres authentiques se mêlent harmonieusement. Des montagnes vertigineuses aux vallées
    paisibles, des merveilles naturelles aux villages ethniques, chaque destination révèle une
    histoire fascinante qui n’attend que vous.
  </p>

  <div class="grid-wrapper">

    {# 1) Có dữ liệu ExperienceSpot từ controller #}
    {% if spots is defined and spots|length > 0 %}

      {% for spot in spots %}
        <article class="grid-card"
                 onclick="window.location='{{ path('app_experience_spot_show', {slug: spot.slug}) }}'">
          <div class="grid-card-title">
            {{ spot.title }}
          </div>

          <img
            src="{{ asset('Image/nord/' ~ spot.imageFilename) }}"
            alt="{{ spot.title }}"
            class="grid-card-image"
          >

          <div class="grid-card-text">
            {# cắt ngắn nội dung để card gọn hơn #}
            {{ spot.shortDescription|slice(0, 260)|nl2br }}{% if spot.shortDescription|length > 260 %}…{% endif %}
          </div>

          <div class="grid-card-footer">
            ♥ {{ spot.likesCount }} likes – {{ spot.comments|length }} comments
          </div>
        </article>
      {% endfor %}

    {# 2) Chưa có dữ liệu DB → dùng nội dung tĩnh cũ (không có like/comment động) #}
    {% else %}

      {# ... phần items tĩnh giữ nguyên như bạn, mình không lặp lại để đỡ dài #}

    {% endif %}

  </div>
</section>
{% endblock %}
